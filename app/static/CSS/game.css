/* =========================================
   VARI√ÅVEIS & TEMA (Caf√© / Madeira / Bege)
   ========================================= */
:root {
    --primary-dark: #3E2723;    /* Caf√© Escuro */
    --primary-light: #5D4037;   /* Marrom Madeira */
    --accent: #D4A373;          /* Bege Dourado */
    --action-color: #E65100;    /* Laranja A√ß√£o */
    
    --card-bg-warm: #F9F6F0;    /* Bege Creme Suave */
    --bg-inner-warm: #F2EDE4;   /* Bege contraste */
    
    --text-main: #212121;
    --text-muted: #757575;
}

body {
    background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary-light) 100%);
    color: var(--text-main);
    overflow: hidden;
    height: 100vh;
    margin: 0;
    font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
}

/* =========================================
   NAVBAR
   ========================================= */
.game-nav {
    background: rgba(249, 246, 240, 0.95);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid rgba(255,255,255,0.3);
    height: 70px;
    z-index: 1050;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    padding: 0 1rem;
}

/* Esconde bot√£o voltar antigo */
.btn-icon { display: none; }

/* Badges e Topo */
.player-badge { font-size: 0.95rem; font-weight: 600; color: var(--primary-dark); }
.vs-badge {
    background: rgba(255,255,255,0.5);
    border: 1px solid rgba(0,0,0,0.1);
    font-weight: 900; color: #aaa;
    text-transform: uppercase; letter-spacing: 1px; font-size: 0.75rem;
}
.avatar-indicator {
    width: 28px; height: 28px; border-radius: 50%;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2); border: 2px solid rgba(0,0,0,0.1);
}
.avatar-indicator.bg-white { background-color: #fff; border-color: #ccc; }
.avatar-indicator.bg-dark { background-color: #333; border-color: #000; }
.glass-badge { background: rgba(255,255,255,0.6); border: 1px solid rgba(0,0,0,0.05); }
.text-primary-dark { color: var(--primary-dark); }
.text-primary-custom { color: var(--primary-dark) !important; }
.transition-hover:hover { transform: translateY(-2px); }

#recordingIndicator {
    font-size: 0.65rem; font-weight: 800; letter-spacing: 0.5px;
    animation: blinkRed 1.5s infinite;
}
@keyframes blinkRed { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }

/* =========================================
   LAYOUT PRINCIPAL
   ========================================= */
.main-container {
    height: calc(100vh - 70px);
    margin-top: 70px;
    display: flex;
}

.game-column {
    flex: 1;
    display: flex; flex-direction: column;
    justify-content: center; align-items: center;
    position: relative; overflow-y: auto;
}

.sidebar-column {
    width: 380px; min-width: 320px;
    height: 100%;
    display: flex; flex-direction: column;
    z-index: 100;
}

/* =========================================
   TABULEIRO
   ========================================= */
.board-wrapper {
    background: var(--card-bg-warm);
    border: 8px solid #8D6E63; border-radius: 6px;
    box-shadow: 0 20px 50px rgba(0,0,0,0.3); padding: 0;
}
.board {
    display: grid;
    grid-template-columns: repeat(8, 1fr); grid-template-rows: repeat(8, 1fr);
    width: 75vmin; height: 75vmin;
    max-width: 600px; max-height: 600px;
    border: 2px solid var(--primary-dark);
}
.cell { width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; position: relative; }
.cell.white { background-color: #EFEBE9; }
.cell.black { background-color: #5D4037; }

.cell.last-move::before {
    content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    background-color: rgba(255, 167, 38, 0.4);
    box-shadow: inset 0 0 10px #FF9800; pointer-events: none; z-index: 1;
}
.cell.highlight { cursor: pointer; }
.cell.highlight::after {
    content: ''; position: absolute; width: 18%; height: 18%;
    background-color: rgba(76, 175, 80, 0.8);
    border-radius: 50%; z-index: 5;
    box-shadow: 0 0 5px rgba(76, 175, 80, 0.5);
}

.piece {
    width: 85%; height: 85%; border-radius: 50%;
    cursor: pointer; transition: transform 0.15s; z-index: 10;
    box-shadow: 0 3px 5px rgba(0,0,0,0.4), inset 0 -3px 5px rgba(0,0,0,0.2);
}
.piece:hover { transform: scale(1.1); }
.piece.white { background: radial-gradient(circle at 35% 35%, #fff, #d7ccc8); border: 1px solid #a1887f; }
.piece.black { background: radial-gradient(circle at 35% 35%, #555, #212121); border: 1px solid #000; }
.piece.selected { box-shadow: 0 0 0 4px #FFC107, 0 5px 10px rgba(0,0,0,0.5); z-index: 20; transform: scale(1.15); }
.piece.king::after { content: "üëë"; font-size: 2rem; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -55%); color: gold; text-shadow: 0 2px 2px rgba(0,0,0,0.8); }

/* =========================================
   SIDEBAR (CHAT & V√çDEO) - CORRE√á√ÉO AQUI
   ========================================= */
.sidebar-card {
    height: 100%;
    display: flex; flex-direction: column;
    background: var(--card-bg-warm);
    border-left: 1px solid rgba(255,255,255,0.5);
    box-shadow: -5px 0 20px rgba(0,0,0,0.05);
}

/* 1. V√≠deo */
.video-section {
    flex: 0 0 auto; height: 220px;
    background: #111; position: relative;
    border-bottom: 2px solid var(--primary-dark);
}
.pip-wrapper {
    position: absolute; bottom: 10px; right: 10px; width: 90px; height: 68px;
    border: 2px solid white; border-radius: 8px; overflow: hidden; z-index: 20; background: #000;
    box-shadow: 0 5px 15px rgba(0,0,0,0.5);
}
.pip-video { width: 100%; height: 100%; object-fit: cover; }

/* 2. Abas */
.custom-tabs .nav-link {
    color: var(--text-muted); background: #ECEFF1; border: none; border-radius: 0; font-weight: 600;
}
.custom-tabs .nav-link.active {
    background: var(--bg-inner-warm); color: var(--action-color); border-bottom: 3px solid var(--action-color);
}

/* 3. √Årea de Conte√∫do do Chat */
.chat-content-area {
    flex: 1; /* Ocupa o resto da altura */
    background-color: var(--bg-inner-warm);
    overflow: hidden;
    position: relative;
    display: flex; flex-direction: column;
    /* Importante: N√£o coloque display: none aqui! */
}

/* Regras espec√≠ficas para as Abas do Bootstrap */
.tab-pane {
    height: 100%;
    width: 100%;
    display: none; /* Esconde abas inativas */
    flex-direction: column;
}

/* Mostra aba ativa com Flex */
.tab-pane.active {
    display: flex !important;
}

/* Lista de Mensagens */
.chat-messages {
    flex: 1; /* Cresce para empurrar o input para o fundo */
    overflow-y: auto;
    padding: 15px;
    display: flex; flex-direction: column; gap: 10px;
}
.chat-messages::-webkit-scrollbar { width: 5px; }
.chat-messages::-webkit-scrollbar-thumb { background: #bdbdbd; border-radius: 4px; }

/* Input Fixo no Rodap√© */
.chat-input-wrapper {
    flex: 0 0 auto; /* Altura fixa, n√£o encolhe */
    background: white;
    padding: 12px;
    border-top: 1px solid rgba(0,0,0,0.05);
    z-index: 10;
}

/* Estilos de Mensagem */
.chat-msg { padding: 8px 14px; border-radius: 12px; font-size: 0.9rem; max-width: 85%; line-height: 1.4; }
.chat-msg.mine { align-self: flex-end; background: var(--primary-dark); color: white; border-bottom-right-radius: 2px; }
.chat-msg.opponent { align-self: flex-start; background: white; color: #333; border: 1px solid #e0e0e0; border-bottom-left-radius: 2px; }
.chat-msg.system { align-self: center; background: rgba(0,0,0,0.05); color: #777; font-size: 0.8rem; border-radius: 20px; padding: 4px 12px; }

.btn-send {
    width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; padding: 0;
    transition: transform 0.2s;
}
.btn-send:hover { transform: scale(1.05); background-color: var(--action-color); }

/* Mobile */
@media (max-width: 991px) {
    body { overflow: auto; height: auto; }
    .main-container { height: auto; flex-direction: column; }
    .game-column { height: auto; padding: 30px 0; overflow: visible; }
    .board { width: 92vmin; height: 92vmin; }
    .sidebar-column { width: 100%; height: 600px; margin-top: 0; border-top: 4px solid var(--primary-dark); }
}